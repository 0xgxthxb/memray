<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>pensieve</title>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
    integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
  <style>{{ css }}</style>

</head>

<body>
  <!-- Header -->
  <nav class="navbar sticky-top navbar-dark bg-dark">
    <a class="navbar-brand" href="#">
      <span class="navbar-brand mb-0 mr-2 h1">pensieve</span>flamegraph
    </a>
    <div class="form-inline">
      <div class="btn-toolbar">
        <button type="button" class="btn btn-outline-light mr-3" data-toggle="modal" data-target="#helpModal">Help </button>
        <button id="invertButton" class="btn btn-outline-light mr-3">Invert</button>
      </div>
      <input id="searchTerm" class="form-control" type="search" placeholder="Search Frame">
    </div>
  </nav>

  <!-- Main Content -->
  <main class="container-fluid">
    <div class="row">
      <div class="col bg-light py-3">
        <div class="chart-container">
          <div id="chart"></div>
        </div>
      </div>
    </div>
  </main>

  <!-- Help Modal -->
  <div class="modal fade" id="helpModal" tabindex="-1" role="dialog" aria-labelledby="helpModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="helpModalLabel">How to interpret flame graphs</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p>
            The flame graph displays a snapshot of memory used across stack frames at the time <b>when the memory usage
            was at its peak</b>.
          </p>
          <p>
            The vertical ordering of the stack frames corresponds to the order of function calls, from parent to
            children.
            The horizontal ordering does not represent the passage of time in the application: they simply represent
            child frames in arbitrary order.
          </p>
          <p>
            On the flame graph, each bar represents a stack frame and shows the code which triggered the memory
            allocation. Hovering over the frame you can also see the overall memory allocated in the given frame and
            its children and the number of times allocations have occurred.
          </p>
          <p>
            You can find more information in the <a target="_blank"  href="https://bbgithub.dev.bloomberg.com/pages/python/bloomberg-pensieve/flamegraph.html">Documentation</a>.
          </p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Javascript -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
  <script src="https://d3js.org/d3.v4.min.js" charset="utf-8"></script>
  <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/d3-tip@0.9.1/dist/index.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/d3-flame-graph@4.0.6/dist/d3-flamegraph.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/js/dist/modal.js"></script>
  <script>
      var flamegraph_data = {{ flamegraph_data }};
      {{ common_js }}
      {{ js }}
  </script>
</body>

</html>
